[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=14cc468c-f0f5-4e9a-8c08-779bebf0b69d
Description=PDMTool
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=FormGlobal
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
//////////////////////////////////
// Init Event
Event FormGlobal.Load
	Const DEIVCE_LIST_NUM = 2
	Const DEVICE_ID_INVALID = -1
	Const DEVICE_ID_R48G = 0
	Const DEVICE_ID_R49P = 1
	Const DEVICE_ID_LIST = "R48G|R49P"
	
	SetDeviceList (DEVICE_ID_LIST)
	
	ResetAll
End Event

//////////////////////////////////
// Click Event
Event FormGlobal.BtnClearLog.Click
	ClearLog
End Event

Event FormGlobal.BtnOK.Click
	CheckDevice
End Event

Event FormGlobal.BtnReset.Click
	ResetAll
End Event

//////////////////////////////////
// Select Event
Event FormGlobal.ComboxDevice.SelectChange
	SetDeviceNormal 
	SetGroupBoxInfo(GetDeviceName)
End Event


//////////////////////////////////
// Check Function
Function CheckDevice()
	If IsValidDeviceIndex Then
		TraceLog "机型 - " + GetDeviceName
		SetDeviceOK
	Else 
		TraceLog "机型信息非法"
		SetDeviceErr
	End If
End Function

//////////////////////////////////
// Device Relations Function
Function SetDeviceList(deviceList)
	FormGlobal.ComboxDevice.List = deviceList
End Function

Function GetDeviceIndex()
	GetDeviceIndex = FormGlobal.ComboxDevice.ListIndex
End Function

Function IsValidDeviceIndex()
	Dim deviceIndex
	deviceIndex = FormGlobal.ComboxDevice.ListIndex
	If 0 > deviceIndex Then
		IsValidDeviceIndex = false
	ElseIf DEIVCE_LIST_NUM <= deviceIndex Then
		IsValidDeviceIndex = false
	Else 
		IsValidDeviceIndex = true
	End If
End Function

Function GetDeviceName()
	Dim deviceList
	deviceList = Split(FormGlobal.ComboxDevice.List, "|")
	GetDeviceName = deviceList(FormGlobal.ComboxDevice.ListIndex)
End Function

Function SetDeviceOK()
	FormGlobal.ComboxDevice.NormalColor = "00FF00"
End Function

Function SetDeviceErr()
	FormGlobal.ComboxDevice.NormalColor = "0000FF"
End Function

Function SetDeviceNormal()
	FormGlobal.ComboxDevice.NormalColor = "A0A0A4"
End Function

Function ResetDevice()
	SetDeviceNormal 
	FormGlobal.ComboxDevice.ListIndex = DEVICE_ID_INVALID
End Function

//////////////////////////////////
// GroupBox Relations Function
Function SetGroupBoxInfo(deviceName)
	FormGlobal.GroupBoxInfo.Caption = "请填写" + deviceName + "机型相关信息"
End Function

Function ResetGroupBoxInfo()
	FormGlobal.GroupBoxInfo.Caption = "请先选择机型"
End Function

//////////////////////////////////
// Common Function
Function ClearLog()
	FormGlobal.InputLog.text = ""
End Function

Function TraceLog(logContent)
	Dim logline
	logline = "日志" + "[" + CStr(Hour(now)) + ":" + CStr(Minute(now)) + ":" + CStr(Second(now)) + "]"
    logline = logline + ": " + CStr(logContent)

    FormGlobal.InputLog.text = FormGlobal.InputLog.text + vbcrlf + logline
End Function

Function ResetAll()
	ResetDevice 
	ResetGroupBoxInfo
End Function
