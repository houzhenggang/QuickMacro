[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=14cc468c-f0f5-4e9a-8c08-779bebf0b69d
Description=PDMTool
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=FormGlobal
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
//////////////////////////////////
// Init Event
Event FormGlobal.Load
	Const PDMTOOL_VERSION = "1.0.0"
	Const DEIVCE_LIST_NUM = 2
	Const DEVICE_ID_INVALID = -1
	Const DEVICE_ID_R48G = 0
	Const DEVICE_ID_R49P = 1
	Const DEVICE_ID_LIST = "R48G|R49P"
	
	SetPDMToolVersion(PDMTOOL_VERSION)
	SetDeviceList (DEVICE_ID_LIST)
	ResetAll
End Event

//////////////////////////////////
// Click Event
Event FormGlobal.BtnClearLog.Click
	ClearLog
End Event

Event FormGlobal.BtnOK.Click
	CheckDevice
End Event

Event FormGlobal.BtnReset.Click
	ResetAll
End Event

//////////////////////////////////
// Select Event
Event FormGlobal.ComboxDevice.SelectChange
	SetDeviceNormal 
	SetGroupBoxInfo(GetDeviceName)
End Event


//////////////////////////////////
// Check Function
Function CheckDevice()
	If IsValidDeviceIndex Then
		TraceLog "机型 - " + GetDeviceName
		SetDeviceOK
	Else 
		TraceLog "机型信息非法"
		SetDeviceErr
	End If
End Function

//////////////////////////////////
// Version Relations Function
Function SetPDMToolVersion(version)
	FormGlobal.LabelVersion.Caption = "版本: " + version
End Function

//////////////////////////////////
// Device Relations Function
Function SetDeviceList(deviceList)
	FormGlobal.ComboxDevice.List = deviceList
End Function

Function GetDeviceIndex()
	GetDeviceIndex = FormGlobal.ComboxDevice.ListIndex
End Function

Function IsValidDeviceIndex()
	Dim deviceIndex
	deviceIndex = FormGlobal.ComboxDevice.ListIndex
	If 0 > deviceIndex Then
		IsValidDeviceIndex = false
	ElseIf DEIVCE_LIST_NUM <= deviceIndex Then
		IsValidDeviceIndex = false
	Else 
		IsValidDeviceIndex = true
	End If
End Function

Function GetDeviceName()
	Dim deviceList
	deviceList = Split(FormGlobal.ComboxDevice.List, "|")
	GetDeviceName = deviceList(FormGlobal.ComboxDevice.ListIndex)
End Function

Function SetDeviceOK()
	FormGlobal.ComboxDevice.NormalColor = "00FF00"
End Function

Function SetDeviceErr()
	FormGlobal.ComboxDevice.NormalColor = "0000FF"
End Function

Function SetDeviceNormal()
	FormGlobal.ComboxDevice.NormalColor = "A0A0A4"
End Function

Function ResetDevice()
	SetDeviceNormal 
	FormGlobal.ComboxDevice.ListIndex = DEVICE_ID_INVALID
End Function

//////////////////////////////////
// GroupBox Relations Function
Function SetGroupBoxInfo(deviceName)
	FormGlobal.GroupBoxInfo.Caption = "请填写" + deviceName + "机型相关信息"
End Function

Function ResetGroupBoxInfo()
	FormGlobal.GroupBoxInfo.Caption = "请先选择机型"
End Function

//////////////////////////////////
// Common Function
Function ClearLog()
	FormGlobal.InputLog.text = ""
End Function

Function TraceLog(logContent)
	Dim logline
	logline = "日志" + "[" + CStr(Hour(now)) + ":" + CStr(Minute(now)) + ":" + CStr(Second(now)) + "]"
    logline = logline + ": " + CStr(logContent)

    FormGlobal.InputLog.text = FormGlobal.InputLog.text + vbcrlf + logline
End Function

Function ResetAll()
	ResetDevice 
	ResetGroupBoxInfo
End Function
